/*


















    DDDDDDDDDDDDD                   AAA               RRRRRRRRRRRRRRRRR   KKKKKKKKK    KKKKKKKKKKKKKKKK    KKKKKKKNNNNNNNN        NNNNNNNNIIIIIIIIII        GGGGGGGGGGGGGHHHHHHHHH     HHHHHHHHHTTTTTTTTTTTTTTTTTTTTTTTRRRRRRRRRRRRRRRRR   HHHHHHHHH     HHHHHHHHHZZZZZZZZZZZZZZZZZZZ
    D::::::::::::DDD               A:::A              R::::::::::::::::R  K:::::::K    K:::::KK:::::::K    K:::::KN:::::::N       N::::::NI::::::::I     GGG::::::::::::GH:::::::H     H:::::::HT:::::::::::::::::::::TR::::::::::::::::R  H:::::::H     H:::::::HZ:::::::::::::::::Z
    D:::::::::::::::DD            A:::::A             R::::::RRRRRR:::::R K:::::::K    K:::::KK:::::::K    K:::::KN::::::::N      N::::::NI::::::::I   GG:::::::::::::::GH:::::::H     H:::::::HT:::::::::::::::::::::TR::::::RRRRRR:::::R H:::::::H     H:::::::HZ:::::::::::::::::Z
    DDD:::::DDDDD:::::D          A:::::::A            RR:::::R     R:::::RK:::::::K   K::::::KK:::::::K   K::::::KN:::::::::N     N::::::NII::::::II  G:::::GGGGGGGG::::GHH::::::H     H::::::HHT:::::TT:::::::TT:::::TRR:::::R     R:::::RHH::::::H     H::::::HHZ:::ZZZZZZZZ:::::Z
      D:::::D    D:::::D        A:::::::::A             R::::R     R:::::RKK::::::K  K:::::KKKKK::::::K  K:::::KKKN::::::::::N    N::::::N  I::::I   G:::::G       GGGGGG  H:::::H     H:::::H  TTTTTT  T:::::T  TTTTTT  R::::R     R:::::R  H:::::H     H:::::H  ZZZZZ     Z:::::Z
      D:::::D     D:::::D      A:::::A:::::A            R::::R     R:::::R  K:::::K K:::::K     K:::::K K:::::K   N:::::::::::N   N::::::N  I::::I  G:::::G                H:::::H     H:::::H          T:::::T          R::::R     R:::::R  H:::::H     H:::::H          Z:::::Z
      D:::::D     D:::::D     A:::::A A:::::A           R::::RRRRRR:::::R   K::::::K:::::K      K::::::K:::::K    N:::::::N::::N  N::::::N  I::::I  G:::::G                H::::::HHHHH::::::H          T:::::T          R::::RRRRRR:::::R   H::::::HHHHH::::::H         Z:::::Z
      D:::::D     D:::::D    A:::::A   A:::::A          R:::::::::::::RR    K:::::::::::K       K:::::::::::K     N::::::N N::::N N::::::N  I::::I  G:::::G    GGGGGGGGGG  H:::::::::::::::::H          T:::::T          R:::::::::::::RR    H:::::::::::::::::H        Z:::::Z
      D:::::D     D:::::D   A:::::A     A:::::A         R::::RRRRRR:::::R   K:::::::::::K       K:::::::::::K     N::::::N  N::::N:::::::N  I::::I  G:::::G    G::::::::G  H:::::::::::::::::H          T:::::T          R::::RRRRRR:::::R   H:::::::::::::::::H       Z:::::Z
      D:::::D     D:::::D  A:::::AAAAAAAAA:::::A        R::::R     R:::::R  K::::::K:::::K      K::::::K:::::K    N::::::N   N:::::::::::N  I::::I  G:::::G    GGGGG::::G  H::::::HHHHH::::::H          T:::::T          R::::R     R:::::R  H::::::HHHHH::::::H      Z:::::Z
      D:::::D     D:::::D A:::::::::::::::::::::A       R::::R     R:::::R  K:::::K K:::::K     K:::::K K:::::K   N::::::N    N::::::::::N  I::::I  G:::::G        G::::G  H:::::H     H:::::H          T:::::T          R::::R     R:::::R  H:::::H     H:::::H     Z:::::Z
      D:::::D    D:::::D A:::::AAAAAAAAAAAAA:::::A      R::::R     R:::::RKK::::::K  K:::::KKKKK::::::K  K:::::KKKN::::::N     N:::::::::N  I::::I   G:::::G       G::::G  H:::::H     H:::::H          T:::::T          R::::R     R:::::R  H:::::H     H:::::H  ZZZ:::::Z     ZZZZZ
    DDD:::::DDDDD:::::D A:::::A             A:::::A   RR:::::R     R:::::RK:::::::K   K::::::KK:::::::K   K::::::KN::::::N      N::::::::NII::::::II  G:::::GGGGGGGG::::GHH::::::H     H::::::HH      TT:::::::TT      RR:::::R     R:::::RHH::::::H     H::::::HHZ::::::ZZZZZZZZ:::Z
    D:::::::::::::::DD A:::::A               A:::::A  R::::::R     R:::::RK:::::::K    K:::::KK:::::::K    K:::::KN::::::N       N:::::::NI::::::::I   GG:::::::::::::::GH:::::::H     H:::::::H      T:::::::::T      R::::::R     R:::::RH:::::::H     H:::::::HZ:::::::::::::::::Z
    D::::::::::::DDD  A:::::A                 A:::::A R::::::R     R:::::RK:::::::K    K:::::KK:::::::K    K:::::KN::::::N        N::::::NI::::::::I     GGG::::::GGG:::GH:::::::H     H:::::::H      T:::::::::T      R::::::R     R:::::RH:::::::H     H:::::::HZ:::::::::::::::::Z
    DDDDDDDDDDDDD    AAAAAAA                   AAAAAAARRRRRRRR     RRRRRRRKKKKKKKKK    KKKKKKKKKKKKKKKK    KKKKKKKNNNNNNNN         NNNNNNNIIIIIIIIII        GGGGGG   GGGGHHHHHHHHH     HHHHHHHHH      TTTTTTTTTTT      RRRRRRRR     RRRRRRRHHHHHHHHH     HHHHHHHHHZZZZZZZZZZZZZZZZZZZ


















*/
/*

    BismiLLAHIR RAHMANIR RAHIM
    It's not how you look or who you are underneath, it's what you do that defines you

*/
/**
    Status : ;
    TC: 0.408/1.000 ;
    DOS: ;
    OJ: ;
**/

#include <bits/stdc++.h>

using namespace std;

#define PB          push_back
#define PF          push_front
#define  V          vector
#define PII         pair <int,int>
#define MII         map <int,int>
#define MSI         map <string,int>
#define MIS         map <int,string>
#define MLI         map <long long int,int>
#define MIL         map <int,long long int>
typedef long long int           LL;
typedef int                     I;
typedef double                  D;
typedef float                   F;
typedef bool                    B;
typedef char                    C;
typedef string                  S;
typedef vector <string>         VS;
typedef vector <int>            VI;
typedef vector <char>           VC;

/* Functions */

I GCD (I x, I y){if (x%y==0) return y; else return (GCD(y,x%y));}
I tree[300010];
void make_tree(int node, int r, int e, int ara[]);
void update_tree (int node, int r, int e, int i, int v);
int sum_tree (int node, int r, int e, int i, int j);

int main()
{
    #ifdef DKRHZ
        freopen("get.txt","r",stdin);
    #endif // DKRHZ

    I t,n,q,i,j,x,a,b,cs=0;
    scanf("%d",&t);
    while (t--)
    {
       cs++;
       I ara[100005];
       scanf("%d%d",&n,&q);
       ara[0]=-1;
       for (i=1;i<=n;i++)
       {
           scanf("%d",&ara[i]);
       }
       make_tree(1,1,n,ara);
       printf("Case %d:\n",cs);
       while (q--)
       {
            scanf("%d",&x);
            if (x==1)
            {
                scanf("%d",&a);
                printf("%d\n",ara[a+1]);
                update_tree(1,1,n,a+1,0);
                ara[a+1]=0;
            }
            else if (x==2)
            {
                scanf("%d%d",&a,&b);
                ara[a+1]+=b;
                update_tree(1,1,n,a+1,ara[a+1]);
            }
            else if (x==3)
            {
                scanf("%d%d",&a,&b);
                printf("%d\n",sum_tree(1,1,n,a+1,b+1));
            }
       }
    }
    return 0;
}

void make_tree(int node, int r, int e, int ara[])
{
    if (r==e)
    {
        tree[node]=ara[r];
        return;
    }
    int left=node*2;
    int right=node*2+1;
    int mid=(r+e)/2;
    make_tree(left,r,mid,ara);
    make_tree(right,mid+1,e,ara);
    tree[node]=tree[left]+tree[right];
    return;
}

void update_tree (int node, int r, int e, int i, int v)
{
    if (r>i || e<i) return;
    else if (r==i && e==i)
    {
        tree[node]=v;
        return;
    }
    int left=node*2;
    int right=node*2+1;
    int mid=(r+e)/2;
    if (i<=mid)
        update_tree(left,r,mid,i,v);
    else
        update_tree(right,mid+1,e,i,v);
    tree[node]=tree[left]+tree[right];
    return;
}

int sum_tree (int node, int r, int e, int i, int j)
{
    if (r>j || e<i) return 0;
    if (r>=i && e<=j)
    {
        return tree[node];
    }
    int left=node*2;
    int right=node*2+1;
    int mid=(r+e)/2;
    if (j<=mid)
        return sum_tree(left,r,mid,i,j);
    else if (i>mid)
        return sum_tree(right,mid+1,e,i,j);
    else
    return sum_tree(left,r,mid,i,j)+sum_tree(right,mid+1,e,i,j);
}
